{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"angular-toastify\";\nimport * as i2 from \"src/app/services/payments/payments.service\";\nimport * as i3 from \"../../components/organisms/header/header.component\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../../components/molecules/filters/filters.component\";\nimport * as i6 from \"../../components/molecules/paginator/paginator.component\";\nimport * as i7 from \"../../components/organisms/table/table.component\";\nimport * as i8 from \"../../components/organisms/delete-dialog/delete-dialog.component\";\nimport * as i9 from \"../../components/organisms/edit-dialog/edit-dialog.component\";\nimport * as i10 from \"../../components/organisms/include-dialog/include-dialog.component\";\n\nfunction DashboardComponent_app_delete_dialog_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-delete-dialog\", 10);\n    i0.ɵɵlistener(\"onClose\", function DashboardComponent_app_delete_dialog_1_Template_app_delete_dialog_onClose_0_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.onDelete($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"payment\", ctx_r0.selectedPayment)(\"modalState\", ctx_r0.deleteModalState);\n  }\n}\n\nfunction DashboardComponent_app_edit_dialog_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-edit-dialog\", 10);\n    i0.ɵɵlistener(\"onClose\", function DashboardComponent_app_edit_dialog_2_Template_app_edit_dialog_onClose_0_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.onEdit($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"payment\", ctx_r1.selectedPayment)(\"modalState\", ctx_r1.editModalState);\n  }\n}\n\nfunction DashboardComponent_app_include_dialog_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-include-dialog\", 11);\n    i0.ɵɵlistener(\"onClose\", function DashboardComponent_app_include_dialog_3_Template_app_include_dialog_onClose_0_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.onCloseIncludeDialog($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"modalState\", ctx_r2.includeModalState);\n  }\n}\n\nexport let DashboardComponent = /*#__PURE__*/(() => {\n  class DashboardComponent {\n    constructor(toastService, paymentsService) {\n      this.toastService = toastService;\n      this.paymentsService = paymentsService;\n      this.filters = {\n        page: 1,\n        limit: 5,\n        sortField: \"username\",\n        sortOrder: \"asc\"\n      };\n      this.pages = 0;\n    }\n\n    ngOnInit() {\n      this.getPayments();\n    }\n\n    ngAfterViewInit() {}\n    /**\n     * @function\n     * Subscribe to payments services and save\n     * the response in payments class member.\n     * @error\n     * exbit a toaster error.\n     */\n\n\n    getPayments() {\n      this.loading = true;\n      this.paymentsService.getPayments(this.filters).subscribe(payments => {\n        const totalCount = payments.headers.get(\"X-Total-Count\");\n        this.pages = Math.ceil(Number(totalCount) / this.filters.limit);\n        this.payments = [...payments.body];\n      }, err => {\n        if (err.status === 401) {\n          this.toastService.error(\"Usuário não autorizado!\");\n        } else {\n          this.toastService.error(\"Ocorreu um erro ao buscar pagamentos!\");\n        }\n\n        this.loading = false;\n      }, () => this.loading = false);\n    }\n    /**\n     * @function\n     * Capture change page size event\n     * and research payments.\n     * @param pageSize\n     */\n\n\n    onChangePageSize(pageSize) {\n      this.filters.limit = pageSize;\n      this.getPayments();\n    }\n    /**\n     * @function\n     * Capture change page event\n     * and research payments.\n     * @param pageSize\n     */\n\n\n    onChangePage(page) {\n      this.filters.page = page;\n      this.getPayments();\n    }\n    /**\n     * @function\n     * Capture change sort field/ order\n     * and research payments.\n     * @param pageSize\n     */\n\n\n    onSort(sortOptions) {\n      this.filters.sortField = sortOptions.sortField;\n      this.filters.sortOrder = sortOptions.sortOrder;\n      this.getPayments();\n    }\n    /**\n     * @function\n     * clear input filters for payment search.\n     */\n\n\n    clearFilters() {\n      delete this.filters[\"name\"];\n      delete this.filters[\"username\"];\n      delete this.filters[\"title\"];\n      delete this.filters[\"value\"];\n      delete this.filters[\"date\"];\n      delete this.filters[\"isPayed\"];\n    }\n    /**\n     * @function\n     * Capture input filters\n     * and search for payments.\n     * @param searchFilters\n     */\n\n\n    searchByString(searchFilters) {\n      this.clearFilters();\n      this.filters[searchFilters.searchField] = searchFilters.searchString;\n      this.filters.page = 1;\n      this.getPayments();\n    }\n\n    onDelete(event) {\n      if (event) this.getPayments();\n      this.selectedPayment = undefined;\n      this.deleteModalState = false;\n    }\n\n    openDeleteModal(event) {\n      this.selectedPayment = Object.assign({}, event);\n      this.deleteModalState = true;\n    }\n\n    openIncludeDialog() {\n      this.includeModalState = true;\n    }\n\n    onCloseIncludeDialog(event) {\n      if (event) this.getPayments();\n      this.includeModalState = false;\n    }\n\n    openEditModal(event) {\n      this.selectedPayment = Object.assign({}, event);\n      this.editModalState = true;\n    }\n\n    onEdit(event) {\n      if (event) this.getPayments();\n      this.selectedPayment = undefined;\n      this.editModalState = false;\n    }\n\n  }\n\n  DashboardComponent.ɵfac = function DashboardComponent_Factory(t) {\n    return new (t || DashboardComponent)(i0.ɵɵdirectiveInject(i1.ToastService), i0.ɵɵdirectiveInject(i2.PaymentsService));\n  };\n\n  DashboardComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: DashboardComponent,\n    selectors: [[\"app-dashboard\"]],\n    decls: 14,\n    vars: 9,\n    consts: [[3, \"payment\", \"modalState\", \"onClose\", 4, \"ngIf\"], [3, \"modalState\", \"onClose\", 4, \"ngIf\"], [1, \"dashboard-title\"], [1, \"dashboard-add-payment\", 3, \"click\"], [1, \"dashboard-content\"], [1, \"dashboard-content-header\"], [3, \"onSearch\"], [3, \"pages\", \"selectedPage\", \"onChangePage\", \"onChangePageSize\"], [1, \"dashboard-content-table\"], [3, \"sortField\", \"sortOrder\", \"payments\", \"loading\", \"openDeleteModal\", \"openEditModal\", \"onChangeSort\"], [3, \"payment\", \"modalState\", \"onClose\"], [3, \"modalState\", \"onClose\"]],\n    template: function DashboardComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"app-header\");\n        i0.ɵɵtemplate(1, DashboardComponent_app_delete_dialog_1_Template, 1, 2, \"app-delete-dialog\", 0);\n        i0.ɵɵtemplate(2, DashboardComponent_app_edit_dialog_2_Template, 1, 2, \"app-edit-dialog\", 0);\n        i0.ɵɵtemplate(3, DashboardComponent_app_include_dialog_3_Template, 1, 1, \"app-include-dialog\", 1);\n        i0.ɵɵelementStart(4, \"h1\", 2);\n        i0.ɵɵtext(5, \"Meus pagamentos\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"button\", 3);\n        i0.ɵɵlistener(\"click\", function DashboardComponent_Template_button_click_6_listener() {\n          return ctx.openIncludeDialog();\n        });\n        i0.ɵɵtext(7, \" ADICIONAR PAGAMENTO\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"div\", 4);\n        i0.ɵɵelementStart(9, \"div\", 5);\n        i0.ɵɵelementStart(10, \"app-filters\", 6);\n        i0.ɵɵlistener(\"onSearch\", function DashboardComponent_Template_app_filters_onSearch_10_listener($event) {\n          return ctx.searchByString($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"app-paginator\", 7);\n        i0.ɵɵlistener(\"onChangePage\", function DashboardComponent_Template_app_paginator_onChangePage_11_listener($event) {\n          return ctx.onChangePage($event);\n        })(\"onChangePageSize\", function DashboardComponent_Template_app_paginator_onChangePageSize_11_listener($event) {\n          return ctx.onChangePageSize($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"div\", 8);\n        i0.ɵɵelementStart(13, \"app-table\", 9);\n        i0.ɵɵlistener(\"openDeleteModal\", function DashboardComponent_Template_app_table_openDeleteModal_13_listener($event) {\n          return ctx.openDeleteModal($event);\n        })(\"openEditModal\", function DashboardComponent_Template_app_table_openEditModal_13_listener($event) {\n          return ctx.openEditModal($event);\n        })(\"onChangeSort\", function DashboardComponent_Template_app_table_onChangeSort_13_listener($event) {\n          return ctx.onSort($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.deleteModalState);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.editModalState);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.includeModalState);\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"pages\", ctx.pages)(\"selectedPage\", ctx.filters.page);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"sortField\", ctx.filters.sortField)(\"sortOrder\", ctx.filters.sortOrder)(\"payments\", ctx.payments)(\"loading\", ctx.loading);\n      }\n    },\n    directives: [i3.HeaderComponent, i4.NgIf, i5.FiltersComponent, i6.PaginatorComponent, i7.TableComponent, i8.DeleteDialogComponent, i9.EditDialogComponent, i10.IncludeDialogComponent],\n    styles: [\".dashboard-title[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif;font-size:36px;font-weight:600;line-height:43.88x;margin-top:30px;margin-left:45px}.dashboard-add-payment[_ngcontent-%COMP%]{background-color:#007dfe;color:#fff;border:none;border-radius:4px;font-family:roboto;font-weight:500;font-size:14px;line-height:16px;padding:10px 20px;float:right;margin-right:55px;margin-top:-15px;cursor:pointer}.dashboard-content[_ngcontent-%COMP%]{background:#fff;min-width:545px;margin:90px 40px 60px;border-radius:8px;box-shadow:0 2px 4px rgba(4,38,82,.06)}.dashboard-content-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start;padding:20px 30px}@media (max-width: 957px){.dashboard-content-header[_ngcontent-%COMP%]{flex-direction:column;justify-content:center;align-items:flex-start}.dashboard-content-header[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-bottom:20px}}\"]\n  });\n  return DashboardComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}